import unittest

from decode_utils import extract_payload


test_qr_code = 'shc:/562976095243206034602924374044603122295953265460346029254\
077280433602870286471674522280928621222566537223704296356254474534240035642333\
641242974314275213941553753414075430312453243240753393759550455573277366057360\
106412933611232742435036968002752296524307132032942603600235860294338096621125\
645336252342755633405693130570557265337563655735724225550265773356473565608217\
503224133232405284068770332695742753664715962387366090827604053425474082039700\
354322410274427634359552570716334417332706328702961206668341059614328050761252\
212570521116520074528554508737400317472757629432726640640036637112431224536237\
504762106570334725563637223097454327743713805077177325643604245757205121068657\
729684508112530615766426075450426004543507371230438375056035210406363442907304\
364452529666035530456126936037675643374734155076404772108562768246736775971613\
438646020350825044472093372573426203357006860232071436024002073456643100024336\
560644038050559205773314224113827330534702131545710763941546977314461263774681\
165113475644538767557604262596764402107775908412804074370062773763234405444002\
931721135372708587452676331520755654160403010425567002459043428052510056227096\
432573403322975702765385568002528212267043663653244557632240058722438360834503\
766425572572237312830554310123237645306411067606039074429714041361008047152537\
144604143385630427055346033396530730477437203093042080056212267763271087058592\
659545012000542420925283777764544356357296358725006422254060744095774220137270\
839414221005244693565537153053143401258672204423769520358362761457538245059713\
338546811335528555866407108220462735560435344682310124211107060127509095725227\
46422645874'


class TestDecode(unittest.TestCase):

    def test_extract_payload(self):
        payload = extract_payload(test_qr_code)

        family_name = payload['vc']\
            ['credentialSubject']\
            ['fhirBundle']\
            ['entry'][0]\
            ['resource']\
            ['name'][0]\
            ['family']
        
        self.assertEqual(family_name, 'Anyperson')

unittest.main()
